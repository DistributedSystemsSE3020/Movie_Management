{"ast":null,"code":"var _jsxFileName = \"D:\\\\University\\\\SLIIT\\\\Lectures\\\\3rdYear\\\\1stSemester\\\\DS\\\\GroupProject\\\\Test\\\\Test\\\\frontend\\\\src\\\\components\\\\CustomerManagement\\\\UpdateProfile\\\\UpdateProfile.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport Button from \"@material-ui/core/Button\";\nimport AddAPhotoIcon from '@material-ui/icons/AddAPhoto';\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\nimport axios from 'axios';\nimport './UpdateProfile.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction UpdateProfile(props) {\n  _s();\n\n  const [firstname, setFirstName] = useState(\"\");\n  const [lastname, setLastName] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [address, setAddress] = useState(\"\");\n  const [userImg, setUserImg] = useState(\"\");\n  const history = useHistory();\n  const [fileInputState, setFileInputState] = useState('');\n  const [selectedFile, setSelectedFile] = useState();\n  const [previewSource, setPreviewSource] = useState(); //fetching user data\n\n  useEffect(() => {\n    async function fetchUser() {\n      await axios.get(`http://localhost:8070/customer/${props.match.params.id}`).then(res => {\n        setFirstName(res.data.result.firstname);\n        setLastName(res.data.result.lastname);\n        setEmail(res.data.result.email);\n        setPhone(res.data.result.phone);\n        setAddress(res.data.result.address);\n        setUserImg(res.data.result.imgUrl);\n      }).catch(error => {\n        alert(\"Failed to fetch user data\");\n      });\n    }\n\n    fetchUser();\n  }, [props]); //handling the image uploading\n\n  const handleFileInputChange = event => {\n    const file = event.target.files[0];\n    previewFile(file);\n    setSelectedFile(file);\n    setFileInputState(event.target.value);\n  }; //display a preview of uploaded image\n\n\n  const previewFile = file => {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n\n    reader.onloadend = () => {\n      setPreviewSource(reader.result);\n    };\n  }; //update the user\n\n\n  async function Update(event) {\n    event.preventDefault();\n    let imgUrl;\n\n    if (previewSource) {\n      const formData = new FormData();\n      formData.append(\"file\", selectedFile);\n      formData.append(\"upload_preset\", \"customer_pictures\");\n\n      try {\n        await axios.post(\"https://api.cloudinary.com/v1_1/movie-reservation/image/upload\", formData).then(res => {\n          imgUrl = res.data.secure_url;\n        });\n      } catch (error) {\n        alert(error);\n      }\n    }\n\n    const updatedCustomer = {\n      firstname,\n      lastname,\n      email,\n      phone,\n      address,\n      imgUrl\n    }; //header with authorization token\n\n    const config = {\n      headers: {\n        \"content-Type\": \"application/json\",\n        Authorization: `${localStorage.getItem(\"customerAuthToken\")}`\n      }\n    };\n\n    try {\n      await axios.put(`http://localhost:8070/customer/updateprofile/${props.match.params.id}`, updatedCustomer, config);\n      alert(\"Updated Successfully\");\n      history.push('/customer/profile');\n    } catch (error) {\n      if (error.response.status === 401) {\n        alert(\"Authentication failed. Please Sign In again\");\n        history.push('/customer/signin');\n      } else {\n        alert(\"Updating Failed\");\n      }\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    align: \"center\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-11\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pb-2 px-5 d-flex align-items-center justify-content-between\",\n          children: /*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Update Profile\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 18\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: Update,\n        encType: \"multipart/form-data\",\n        className: \"boxUpdate\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-8\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"row\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-6 mb-4\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-group5\",\n                  children: /*#__PURE__*/_jsxDEV(OutlinedInput, {\n                    type: \"text\",\n                    id: \"firstname\",\n                    placeholder: \"First Name\",\n                    required: true,\n                    fullWidth: true,\n                    value: firstname,\n                    onChange: event => {\n                      setFirstName(event.target.value);\n                    },\n                    inputProps: {\n                      style: {\n                        padding: 12\n                      }\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 120,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 119,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 118,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-6 mb-4\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-group5\",\n                  children: /*#__PURE__*/_jsxDEV(OutlinedInput, {\n                    type: \"text\",\n                    id: \"lastname\",\n                    placeholder: \"Last Name\",\n                    required: true,\n                    fullWidth: true,\n                    value: lastname,\n                    onChange: event => {\n                      setLastName(event.target.value);\n                    },\n                    inputProps: {\n                      style: {\n                        padding: 12\n                      }\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 130,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 129,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 128,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-6 mb-4\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-group5\",\n                  children: /*#__PURE__*/_jsxDEV(OutlinedInput, {\n                    type: \"tel\",\n                    id: \"phone\",\n                    placeholder: \"phone\",\n                    required: true,\n                    fullWidth: true,\n                    value: phone,\n                    onChange: event => {\n                      setPhone(event.target.value);\n                    },\n                    inputProps: {\n                      style: {\n                        padding: 12\n                      },\n                      pattern: \"[0-9]{10}\"\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 140,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 139,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 138,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-6 mb-4\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-group5\",\n                  children: /*#__PURE__*/_jsxDEV(OutlinedInput, {\n                    type: \"email\",\n                    id: \"email\",\n                    placeholder: \"Email\",\n                    required: true,\n                    fullWidth: true,\n                    value: email,\n                    onChange: event => {\n                      setEmail(event.target.value);\n                    },\n                    inputProps: {\n                      style: {\n                        padding: 12\n                      }\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 150,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 149,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-12 mb-4\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-group5\",\n                  children: /*#__PURE__*/_jsxDEV(OutlinedInput, {\n                    type: \"text\",\n                    id: \"address\",\n                    placeholder: \"Address\",\n                    required: true,\n                    fullWidth: true,\n                    value: address,\n                    onChange: event => {\n                      setAddress(event.target.value);\n                    },\n                    inputProps: {\n                      style: {\n                        padding: 12\n                      }\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 160,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 159,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 158,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-4 d-flex justify-content-center\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [previewSource ? /*#__PURE__*/_jsxDEV(\"img\", {\n                src: previewSource,\n                alt: \"preview\",\n                className: \"previewImg\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 37\n              }, this) : userImg === \"\" ? /*#__PURE__*/_jsxDEV(\"img\", {\n                src: \"/images/avatar.jpg\",\n                alt: \"preview\",\n                className: \"previewImg\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 175,\n                columnNumber: 37\n              }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n                src: `${userImg}`,\n                className: \"previewImg\",\n                alt: \"profile pic\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 177,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group5\",\n                children: /*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"profilepic\",\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    style: {\n                      display: 'none'\n                    },\n                    id: \"profilepic\",\n                    name: \"profilepic\",\n                    type: \"file\",\n                    onChange: handleFileInputChange,\n                    value: fileInputState\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 181,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    color: \"primary\",\n                    variant: \"contained\",\n                    component: \"span\",\n                    children: [/*#__PURE__*/_jsxDEV(AddAPhotoIcon, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 191,\n                      columnNumber: 45\n                    }, this), \" \\xA0 Upload Profile Picture\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 190,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 180,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 179,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-8\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group5\",\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-submit-btn mb-1\",\n                type: \"submit\",\n                value: \"Update\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 201,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 200,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 9\n  }, this);\n}\n\n_s(UpdateProfile, \"N6/C9XT8tsPJnsTWwtxhu1dMFkQ=\", false, function () {\n  return [useHistory];\n});\n\n_c = UpdateProfile;\nexport default UpdateProfile;\n\nvar _c;\n\n$RefreshReg$(_c, \"UpdateProfile\");","map":{"version":3,"sources":["D:/University/SLIIT/Lectures/3rdYear/1stSemester/DS/GroupProject/Test/Test/frontend/src/components/CustomerManagement/UpdateProfile/UpdateProfile.js"],"names":["React","useState","useEffect","useHistory","Button","AddAPhotoIcon","OutlinedInput","axios","UpdateProfile","props","firstname","setFirstName","lastname","setLastName","email","setEmail","phone","setPhone","address","setAddress","userImg","setUserImg","history","fileInputState","setFileInputState","selectedFile","setSelectedFile","previewSource","setPreviewSource","fetchUser","get","match","params","id","then","res","data","result","imgUrl","catch","error","alert","handleFileInputChange","event","file","target","files","previewFile","value","reader","FileReader","readAsDataURL","onloadend","Update","preventDefault","formData","FormData","append","post","secure_url","updatedCustomer","config","headers","Authorization","localStorage","getItem","put","push","response","status","style","padding","pattern","display"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\nimport { useHistory } from 'react-router-dom';\nimport Button from \"@material-ui/core/Button\";\nimport AddAPhotoIcon from '@material-ui/icons/AddAPhoto';\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\nimport axios from 'axios';\nimport './UpdateProfile.css';\n\nfunction UpdateProfile(props) {\n    const [firstname,setFirstName] = useState(\"\");\n    const [lastname,setLastName] = useState(\"\");\n    const [email,setEmail] = useState(\"\");\n    const [phone,setPhone] = useState(\"\");\n    const [address,setAddress] = useState(\"\");\n    const [userImg, setUserImg] = useState(\"\");\n\n    const history = useHistory();\n    const [fileInputState, setFileInputState] = useState('');\n    const [selectedFile, setSelectedFile] = useState();\n    const [previewSource, setPreviewSource] = useState();\n\n    //fetching user data\n    useEffect(()=>{\n        async function fetchUser(){\n            await axios.get(`http://localhost:8070/customer/${props.match.params.id}`).then((res)=>{\n                setFirstName(res.data.result.firstname)\n                setLastName(res.data.result.lastname)\n                setEmail(res.data.result.email)\n                setPhone(res.data.result.phone)\n                setAddress(res.data.result.address)\n                setUserImg(res.data.result.imgUrl)\n            }).catch((error)=>{\n                alert(\"Failed to fetch user data\")\n            })\n        }\n        fetchUser()\n    },[props]);\n\n    //handling the image uploading\n    const handleFileInputChange = (event) => {\n        const file = event.target.files[0];\n        previewFile(file);\n        setSelectedFile(file);\n        setFileInputState(event.target.value);\n    };\n\n\n    //display a preview of uploaded image\n    const previewFile = (file) => {\n        const reader = new FileReader();\n        reader.readAsDataURL(file)\n        reader.onloadend = () => {\n            setPreviewSource(reader.result)\n        }\n    }\n\n    //update the user\n    async function Update(event){\n\n        event.preventDefault();\n\n        let imgUrl\n\n        if(previewSource){\n            const formData = new FormData();\n            formData.append(\"file\", selectedFile) \n            formData.append(\"upload_preset\", \"customer_pictures\")\n\n            try {\n                await axios.post(\"https://api.cloudinary.com/v1_1/movie-reservation/image/upload\", formData).then((res) =>{\n                    imgUrl = res.data.secure_url\n                })\n            } catch (error) {\n                alert(error)\n            }\n        }\n\n        const updatedCustomer = {firstname,lastname,email,phone,address,imgUrl}\n\n        //header with authorization token\n        const config = {\n            headers: {\n                \"content-Type\": \"application/json\",\n                Authorization: `${localStorage.getItem(\"customerAuthToken\")}`,\n            }\n        };\n\n        try {\n            await axios.put(`http://localhost:8070/customer/updateprofile/${props.match.params.id}`,updatedCustomer, config);\n                alert(\"Updated Successfully\")\n                history.push('/customer/profile')\n        } catch (error) {\n            if(error.response.status === 401){\n                alert(\"Authentication failed. Please Sign In again\")\n                history.push('/customer/signin')\n            } else{\n                alert(\"Updating Failed\")\n            }\n        }    \n    }\n\n    return (\n        <div className=\"container\" align=\"center\">\n            <div className=\"row\">\n                <div className=\"col-1\">\n                </div>\n                 <div className=\"col-11\">\n                    <div className=\"pb-2 px-5 d-flex align-items-center justify-content-between\">\n                        <h2>Update Profile</h2>\n                    </div>\n                </div>\n            </div>\n            <div className=\"\">\n                <form onSubmit={Update} encType=\"multipart/form-data\" className=\"boxUpdate\">\n                    <div className=\"row\">\n                        <div className=\"col-8\">\n                            <div className=\"row\">\n                                <div className=\"col-md-6 mb-4\">\n                                    <div className=\"form-group5\">\n                                        <OutlinedInput\n                                            type=\"text\" id=\"firstname\" placeholder=\"First Name\" required fullWidth\n                                            value={firstname}\n                                            onChange={(event)=> {setFirstName(event.target.value)}}\n                                            inputProps={{style: {padding: 12}}}\n                                        />\n                                    </div>\n                                </div>\n                                <div className=\"col-md-6 mb-4\">\n                                    <div className=\"form-group5\">\n                                        <OutlinedInput  \n                                            type=\"text\" id=\"lastname\" placeholder=\"Last Name\" required fullWidth\n                                            value={lastname}\n                                            onChange={(event)=> {setLastName(event.target.value)}}\n                                            inputProps={{style: {padding: 12}}}\n                                        />\n                                    </div>\n                                </div>\n                                <div className=\"col-md-6 mb-4\">\n                                    <div className=\"form-group5\">\n                                        <OutlinedInput \n                                            type=\"tel\" id=\"phone\" placeholder=\"phone\" required fullWidth\n                                            value={phone}\n                                            onChange={(event)=> {setPhone(event.target.value)}}\n                                            inputProps={{style: {padding: 12}, pattern: \"[0-9]{10}\" }}\n                                        />\n                                    </div>\n                                </div>\n                                <div className=\"col-md-6 mb-4\">\n                                    <div className=\"form-group5\">\n                                        <OutlinedInput  \n                                            type=\"email\" id=\"email\" placeholder=\"Email\" required fullWidth\n                                            value={email}\n                                            onChange={(event)=> {setEmail(event.target.value)}}\n                                            inputProps={{style: {padding: 12}}}\n                                        />\n                                    </div>\n                                </div>\n                                <div className=\"col-md-12 mb-4\">\n                                    <div className=\"form-group5\">\n                                        <OutlinedInput \n                                            type=\"text\" id=\"address\" placeholder=\"Address\" required fullWidth\n                                            value={address}\n                                            onChange={(event)=> {setAddress(event.target.value)}}\n                                            inputProps={{style: {padding: 12}}}\n                                        />\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"col-4 d-flex justify-content-center\">\n                            <div>\n                                { previewSource  ?\n                                    <img src={previewSource} alt=\"preview\" className=\"previewImg\"/>\n                                : userImg === \"\"? \n                                    <img src=\"/images/avatar.jpg\" alt=\"preview\" className=\"previewImg\"/>\n                                :\n                                    <img src={`${userImg}`} className=\"previewImg\" alt=\"profile pic\"/>\n                                }\n                                <div className=\"form-group5\">\n                                    <label htmlFor=\"profilepic\">\n                                        <input\n                                            style={{ display: 'none' }}\n                                            id=\"profilepic\"\n                                            name=\"profilepic\"\n                                            type=\"file\"\n                                            onChange={handleFileInputChange}\n                                            value={fileInputState}\n                                        />\n\n                                        <Button color=\"primary\" variant=\"contained\" component=\"span\">\n                                            <AddAPhotoIcon/> &nbsp; Upload Profile Picture\n                                        </Button>\n                                    </label>\n                                </div>\n                            </div>\n                        </div>\n                    </div>   \n                    <div className=\"row\">\n                        <div className=\"col-md-8\">\n                            <div className=\"form-group5\">\n                                <input className=\"form-submit-btn mb-1\" type=\"submit\" value=\"Update\" />\n                            </div> \n                        </div>\n                    </div> \n                </form>     \n            </div>                    \n        </div>\n    )\n}\n\nexport default UpdateProfile\n"]},"metadata":{},"sourceType":"module"}